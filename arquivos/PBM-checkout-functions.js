var QdPbmCheckout={sever:"//ssl-202418.kinghost.net/araujo-pbm",init:function(){QdPbmCheckout.cookieRenew()},payment:function(){QdPbmCheckout.userIsAuthenticated(function(){QdPbmCheckout.validateItems()})},cookieRenew:function(){$.cookie("qdPbm",$.cookie("qdPbm")||"",{path:"/",expires:1})},userIsAuthenticated:function(a){vtexjs.checkout.orderForm.canEditData?a():vtexid.start()},itemsValidated:function(){$(document.body).addClass("qd-loading");$.ajax({url:"/api/checkout/pub/gift-cards/providers",type:"GET",
contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(a){vtexjs.checkout.sendAttachment("paymentData",{giftCards:[{inUse:!0,isSpecialCard:!0,provider:a[0].id,redemptionCode:$.cookie("qdPbm")}],payments:vtexjs.checkout.orderForm.paymentData.payments}).always(function(){$(document.body).removeClass("qd-loading")})})},validateItems:function(){$(document.body).addClass("qd-loading");$.ajax({url:QdPbmCheckout.sever+"/checkout-check",dataType:"json",type:"POST",data:{items:JSON.stringify(vtexjs.checkout.orderForm.items),
orderId:$.cookie("qdPbm")},complete:function(){$(document.body).removeClass("qd-loading")}}).done(function(a){if(a.pbmAvailable)for(var b=function(){d==e&&(0!=d&&QdPbmCheckout.validateItems(),d==e&&QdPbmCheckout.itemsValidated())},d=0,e=0,c=0;c<a.items.length;c++)a.items[c].Pbm&&(a.items[c].PbmValid?b():(d++,QdPbmCheckout.preAuth(a,a.items[c]).always(function(){e++;b()})))})},preAuth:function(a,b){return $.ajax({url:QdPbmCheckout.sever+"/pre-auth",dataType:"json",type:"POST",data:{cpf:a.cpf,qtt:b.quantity,
bDate:"",productId:b.productId,sku:b.id,orderId:$.cookie("qdPbm")}})}};$(QdPbmCheckout.init);